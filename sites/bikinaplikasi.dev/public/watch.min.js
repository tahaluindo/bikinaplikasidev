$(document).ready(() => {
    async function q() {
        await fetch(settings.linkToCheckTokenExpired, {mode: "cors"}).then(a => a.json()).then(a => {
            0 === a.code || 100500 === a.code || tokenHasExpired || (s(settings.messageTokenHasExpired), tokenHasExpired = !0, w())
        })
    }

    function r() {
        let a = new Date, b = parseInt(a.getMinutes() / settings.chartTimeframe) * settings.chartTimeframe;
        a.setMinutes(b + settings.chartTimeframe), a.setSeconds(-settings.delayInSecondToOpenPosition), console.log(settings.messageTimeToOpenPosition + a.toLocaleString());
        let c = new Date;
        c.setMinutes(b - settings.chartTimeframe), c.setSeconds(0), timeBefore = c.toLocaleString();
        let d = new Date;
        return d.setMinutes(b), d.setSeconds(0), timeDetect = d.toLocaleString(), a.toLocaleString()
    }

    function s(a) {
        let b = {telegram_id: settings.telegram_id, message: a, repeat: settings.callTelegramMessageRepeat};
        window.open(settings.linkToCallTelegramMessage + "?" + $.param(b))
    }

    function t() {
        console.log(settings.messageToGetAttributes);
        let a = {
            timeBefore: timeBefore,
            timeDetect: timeDetect,
            timeToOpenPosition: r(),
            token_bearer: settings.token_bearer,
            numOfTelegramCallNotice: settings.numOfTelegramCallNotice,
            pair: pair,
            coin_id: settings.coin_id,
            margin: settings.margin,
            leverage: settings.leverage,
            order_type: order_type,
            price: null,
            stop_loss_rate: null,
            take_profit_rate: null,
            toBep_rate: null,
            logicName: logicName
        };
        return 0 == order_type ? a.price = chart_price_c + settings.addedPoints : a.price = chart_price_c - settings.addedPoints, a.stop_loss_rate = settings.stop_loss_rate, a.take_profit_rate = settings.take_profit_rate, a.toBep_rate = settings.toBep_rate, a
    }

    async function u(a) {
        console.log(settings.messageWillBeOpenPositionAt + a.timeToOpenPosition), hasOpenPosition ? hasOpenPosition && (console.log("cek posisi telah dilakukan, tidak bisa dilakukan lagi diwaktu ini.."), await new Promise(a => setTimeout(a, 12e4))) : (hasOpenPosition = !0, null == window.open(settings.linkToOpenPosition + "?" + $.param(a)) ? (console.log("Gagal buka windowww"), s("Gagal buka windowww")) : (await new Promise(a => setTimeout(a, 12e4)), hasOpenPosition = !1, logicName = null))
    }

    function v() {
        if ($(".series-OYqjX7Sg > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div:nth-child(2)").length < 1) {
            s(settings.messageClassNameHasChange);
            return
        }
        chart_price_o = parseFloat($(".series-OYqjX7Sg > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div:nth-child(2)").text()), chart_price_h = parseFloat($(".series-OYqjX7Sg > div:nth-child(2) > div:nth-child(1) > div:nth-child(3) > div:nth-child(2)").text()), chart_price_l = parseFloat($(".series-OYqjX7Sg > div:nth-child(2) > div:nth-child(1) > div:nth-child(4) > div:nth-child(2)").text()), chart_price_c = parseFloat($(".series-OYqjX7Sg > div:nth-child(2) > div:nth-child(1) > div:nth-child(5) > div:nth-child(2)").text()), chart_psr_blue_1 = $(".valueItem-OYqjX7Sg").eq(9).text(), chart_psr_blue_2 = $(".valueItem-OYqjX7Sg").eq(10).text(), chart_psr_blue_3 = $(".valueItem-OYqjX7Sg").eq(11).text(), chart_psr_blue_4 = $(".valueItem-OYqjX7Sg").eq(12).text(), chart_bb_sma_42 = parseFloat($("div.item-OYqjX7Sg:nth-child(3) > div:nth-child(2) > div:nth-child(1) > div:nth-child(1)").text()), chart_macd_signal = $("div.sourcesWrapper-OYqjX7Sg:nth-child(1) > div:nth-child(2) > div:nth-child(2) > div:nth-child(2) > div:nth-child(1) > div:nth-child(3) > div:nth-child(1)").text(), chart_macd_cross = $("div.sourcesWrapper-OYqjX7Sg:nth-child(1) > div:nth-child(2) > div:nth-child(2) > div:nth-child(2) > div:nth-child(1) > div:nth-child(4) > div:nth-child(1)").text()
    }

    function w() {
        let b = new Audio("https://media.geeksforgeeks.org/wp-content/uploads/20190531135120/beep.mp3");
        for (let a = 0; a < settings.numOfSoundNotice; a++) setTimeout(() => {
            b.play()
        }, settings.delayAudioPlay * a)
    }

    function x() {
        return "\u2205" === chart_psr_blue_2 && "\u2205" != chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_l && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && "\u2205" !== chart_macd_cross ? (logicName = "isLogic1", console.log("is logic 1 true sell"), order_type = 1, !0) : !!("\u2205" !== chart_psr_blue_2 && "\u2205" === chart_psr_blue_4 && chart_psr_blue_1 <= chart_price_l && (chart_price_o <= chart_bb_sma_42 && chart_price_c >= chart_bb_sma_42 || chart_price_c <= chart_bb_sma_42 && chart_price_o >= chart_bb_sma_42)) && "\u2205" !== chart_macd_cross && (logicName = "isLogic1", console.log("is logic 1 true buy"), order_type = 0, !0)
    }

    function b() {
        return v(), !!(!x() && "\u2205" === chart_psr_blue_2 && "\u2205" !== chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_h && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross) && (logicName = "psr_sell_macd_blue_bb_between_macd_blue", console.log("psr_sell_macd_blue_bb_between_macd_blue"), order_type = 1, !0)
    }

    function a() {
        return v(), !!(!x() && "\u2205" !== chart_psr_blue_2 && "\u2205" === chart_psr_blue_4 && chart_psr_blue_1 <= chart_price_l && chart_macd_signal.toLowerCase().indexOf("\u2212") >= 0 && "\u2205" === chart_macd_cross && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && chart_macd_signal.toLowerCase().indexOf("") >= 0 && "\u2205" === chart_macd_cross) && (logicName = "psr_buy_macd_red_bb_between_macd_red", console.log("psr_buy_macd_red_bb_between_macd_red"), order_type = 0, !0)
    }

    function c() {
        return v(), !!(!x() && "\u2205" !== chart_psr_blue_2 && "\u2205" === chart_psr_blue_4 && chart_psr_blue_1 <= chart_price_l && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross) && (logicName = "psr_buy_macd_blue_bb_between_macd_blue", console.log("psr_buy_macd_blue_bb_between_macd_blue"), order_type = 1, !0)
    }

    function d() {
        return v(), !!(!x() && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && chart_macd_signal.toLowerCase().indexOf("") >= 0 && "\u2205" === chart_macd_cross && "\u2205" === chart_psr_blue_2 && "\u2205" !== chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_l && chart_macd_signal.toLowerCase().indexOf("\u2212") >= 0 && "\u2205" === chart_macd_cross) && (logicName = "psr_sell_macd_red_bb_between_macd_red", console.log("psr_sell_macd_red_bb_between_macd_red"), order_type = 0, !0)
    }

    function e() {
        return v(), !!(!x() && !a() && !d() && "\u2205" !== chart_psr_blue_2 && "\u2205" === chart_psr_blue_4 && chart_psr_blue_1 <= chart_price_l && chart_macd_signal.toLowerCase().indexOf("\u2212") >= 0 && "\u2205" === chart_macd_cross) && (logicName = "psr_buy_macd_red", console.log("psr_buy_macd_red"), order_type = 0, !0)
    }

    function f() {
        return v(), !!(!x() && "\u2205" !== chart_psr_blue_2 && "\u2205" === chart_psr_blue_4 && chart_psr_blue_1 <= chart_price_l && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" !== chart_macd_cross) && (logicName = "psr_buy_macd_cross", console.log("psr_buy_macd_cross"), order_type = 0, !0)
    }

    function g() {
        return v(), !!(!x() && !c() && !b() && "\u2205" !== chart_psr_blue_2 && "\u2205" === chart_psr_blue_4 && chart_psr_blue_1 <= chart_price_l && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross) && (logicName = "psr_buy_macd_blue", console.log("psr_buy_macd_blue"), order_type = 0, !0)
    }

    function h() {
        return v(), !!(!x() && !b() && !c() && "\u2205" === chart_psr_blue_2 && "\u2205" !== chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_h && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross) && (logicName = "psr_sell_macd_blue", console.log("psr_sell_macd_blue"), order_type = 1, !0)
    }

    function i() {
        return v(), !!(!x() && "\u2205" === chart_psr_blue_2 && "\u2205" !== chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_l && chart_macd_signal.toLowerCase().indexOf("") >= 0 && "\u2205" !== chart_macd_cross && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" !== chart_macd_cross) && (logicName = "psr_sell_macd_cross_bb_between_macd_cross_to_blue", console.log("psr_sell_macd_cross_bb_between_macd_cross_to_blue"), order_type = 1, !0)
    }

    function j() {
        return v(), !!(!x() && "\u2205" === chart_psr_blue_2 && "\u2205" !== chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_l && chart_macd_signal.toLowerCase().indexOf("") >= 0 && "\u2205" !== chart_macd_cross) && (logicName = "psr_sell_macd_cross", console.log("psr_sell_macd_cross"), order_type = 1, !0)
    }

    function k() {
        return v(), !!(!x() && !d() && !a() && "\u2205" === chart_psr_blue_2 && "\u2205" !== chart_psr_blue_4 && chart_psr_blue_1 >= chart_price_l && chart_macd_signal.toLowerCase().indexOf("\u2212") >= 0 && "\u2205" === chart_macd_cross) && (logicName = "psr_sell_macd_red", console.log("psr_sell_macd_red"), order_type = 1, !0)
    }

    function l() {
        return v(), !!(!x() && !b() && !c() && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" === chart_macd_cross) && (logicName = "bb_between_macd_blue", console.log("bb_between_macd_blue"), order_type = 0, !0)
    }

    function m() {
        return v(), !!(!x() && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && 0 > chart_macd_signal.toLowerCase().indexOf("\u2212") && "\u2205" !== chart_macd_cross) && (logicName = "bb_between_macd_cross_to_blue", console.log("bb_between_macd_cross_to_blue"), order_type = 0, !0)
    }

    function n() {
        return v(), !!(!x() && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && chart_macd_signal.toLowerCase().indexOf("\u2212") >= 0 && "\u2205" !== chart_macd_cross) && (logicName = "bb_between_macd_cross_to_red", console.log("bb_between_macd_cross_to_red"), order_type = 1, !0)
    }

    function o() {
        return v(), !!(!x() && !d() && !a() && (chart_price_o >= chart_bb_sma_42 && chart_price_c <= chart_bb_sma_42 || chart_price_c >= chart_bb_sma_42 && chart_price_o <= chart_bb_sma_42) && chart_macd_signal.toLowerCase().indexOf("\u2212") >= 0 && "\u2205" === chart_macd_cross) && (logicName = "bb_between_macd_red", console.log("bb_between_macd_red"), order_type = 1, !0)
    }

    function p() {
        let p = r();
        console.log("Posisi akan dicek pada: " + p), setInterval(async () => {
            await q()
        }, settings.delayToCheckToken);
        let s = setInterval(async () => {
            logicName = null, console.log(i()), console.log(a()), console.log(c()), console.log(b()), console.log(d()), console.log(e()), console.log(f()), console.log(g()), console.log(h()), console.log(j()), console.log(k()), console.log(l()), console.log(m()), console.log(n()), console.log(o()), x(), v();
            var q = new Date;
            q.setSeconds(0, 0);
            var r = q.toLocaleString();
            if (console.log("Waktu sekarang: " + r), console.log(settings.messageTimeToOpenPosition + p), tokenHasExpired) {
                clearInterval(s);
                return
            }
            if (!hasOpenPosition && null != logicName) {
                var w = t();
                for (a = 0; a <= 60; a += settings.chartTimeframe) if ((new Date().getMinutes() === a - 1 || 59 === new Date().getMinutes()) && 58 == new Date().getSeconds()) {
                    setTimeout(() => {
                        u(w), console.log("masuk melalui double check")
                    }, 0);
                    break
                }
            }
        }, settings.intervalToCheckLogic)
    }

    host = "https://bikinaplikasi.site/public/bot-trading", host_online = "https://bikinaplikasi.dev/bot-trading", pair = $("#header-toolbar-symbol-search > div:nth-child(1)").text(), order_type = null, tokenHasExpired = !1, attributesToOpenPosition = {}, timeBefore = null, timeDetect = null, logicName = null, hasOpenPosition = !1, settings = {
        callTelegramMessageRepeat: 2,
        chartTimeframe: 15,
        coin_id: 22,
        delayAudioPlay: 5e3,
        delayInSecondToOpenPosition: 0,
        delayToCheckToken: 15e3,
        delayToNextDetection: 12e4,
        intervalToCheckLogic: 1e3,
        leverage: 10,
        linkToCallTelegramMessage: host + "/call-telegram-message",
        linkToOpenPosition: host + "/position",
        linkToSendTelegramMessage: host + "/send-telegram-message",
        linkToSendTelegramMessage2: host + "/send-telegram-message-2",
        linkToTellTokenExpired: host + "/token-expired",
        linkToCheckTokenExpired: host_online + "/check-token-expired",
        urlSetBep: host + "/set-bep",
        urlCancelOrder: host + "/cancel-order",
        margin: 20.5,
        messageAttributesFailToGet: "Attribute gagal didapatkan",
        messageClassNameHasChange: "Nama class telah diganti, silakan update manual",
        messageHaveClosePosition: `Posisi untuk pair ${pair} telah ditutup`,
        messageHaveErrorClosePosition: `Terjadi untuk pair ${pair} saat menutup posisi`,
        messageHaveErrorOpenPosition: `Terjadi untuk pair ${pair} saat membuka posisi`,
        messageHaveOpenPosition: `Posisi untuk pair ${pair} berhasil dibuka`,
        messageHaveSuccessSendCallTelegramMessage: "Berhasil mengirimkan pesan telepon ke telegram",
        messageHaveSuccessSendTelegramMessage: "Berhasil mengirimkan pesan ke telegram",
        messageTimeToOpenPosition: "time to open position ",
        messageToGetAttributes: "Sedang mendapatkan attributes",
        messageTokenHasExpired: "Token sudah expired mohon update secara manual",
        messageWillBeOpenPositionAt: "Posisi akan segera dibuka pada: ",
        numOfSoundNotice: 1e3,
        numOfTelegramCallNotice: 2,
        stop_loss_rate: 15,
        take_profit_rate: 60,
        telegram_id: "ramdanriawan",
        toBep_rate: 20,
        addedPoints: 0,
        token_bearer: "eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiI5MTY4NTU2MzA4MjI5NTcwNTgiLCJleHAiOjE2NTg0MjQyNzV9.bPednu89gMWGskSvjCRTs6B2x7qSk5QiuBZud5BuBGqH5o47tpY06zTCoKLsMg_ntNntoNUSpZw91FzhoU3hCg"
    }, chart_price_o = null, chart_price_h = null, chart_price_l = null, chart_price_c = null, chart_psr_blue_1 = null, chart_psr_blue_2 = null, chart_psr_blue_3 = null, chart_psr_blue_4 = null, chart_bb_sma_42 = null, chart_macd_signal = null, console.log(d()), console.log(i()), console.log(a()), console.log(c()), console.log(a()), console.log(b()), console.log(e()), console.log(f()), console.log(g()), console.log(h()), console.log(j()), console.log(k()), console.log(l()), console.log(m()), console.log(n()), console.log(o()), p()
})